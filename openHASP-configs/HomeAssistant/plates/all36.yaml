  dining:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.dining','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.dining','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.dining','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.hallway_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"

      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.hallway_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"

# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.dining_light_12", "on") else 0 }}'
          "text": '{{ "Outside" if is_state("light.dining_light_12", "on") else "Outside" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.dining_light_12"
      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.dining_light_14", "on") else 0 }}'
          "text": '{{ "Dining" if is_state("light.dining_light_14", "on") else "Dining" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.dining_light_14"

      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.downhall_light_14", "on") else 0 }}'
          "text": '{{ "Hallway" if is_state("light.downhall_light_14", "on") else "Hallway" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.downhall_light_14"

      - obj: "p1b4" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("switch.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.unused"

      - obj: "p1b5" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("switch.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.unused"

      - obj: "p1b6" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("switch.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.unused"

      - obj: "p1b9" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.garden_lights", "on") else 0 }}'
          "text": '{{ "Garden" if is_state("switch.garden_lights", "on") else "Garden" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.garden_lights"


# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"
# End of Alarm Panel




# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.dining
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}
  downbath:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.downbath','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.downbath','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.downbath','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.hallway_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"

      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.downbath_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"

# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.downbath_light_12", "on") else 0 }}'
          "text": '{{ "\uE6E8 Bathroom" if is_state("light.downbath_light_12", "on") else "\uE335 Bathroom" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.downbath_light_12"

      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.downhall_light_14", "on") else 0 }}'
          "text": '{{ "\uE6E8 Hallway" if is_state("light.downhall_light_14", "on") else "\uE335 Hallway" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.downhall_light_14"
              
      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("switch.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.unused"


      - obj: "p1b4" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("switch.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.unused"

      - obj: "p1b5" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("switch.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.unused"

      - obj: "p1b6" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.downbath_light_14", "on") else 0 }}'
          "text": '{{ "\uE425 Mirror" if is_state("light.downbath_light_14", "on") else "\uE425 Mirror" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.downbath_light_14"


      - obj: "p1b7"
        properties:
          "text": >
            {% if is_state('cover.velux_downstairs_bathroom', 'closing') %}
            {{ "\uE4DB" | e }}
            {%-elif is_state('cover.velux_downstairs_bathroom', 'opening') %}
            {{ "\uE4DB" | e }}
            {%-elif is_state('cover.velux_downstairs_bathroom', 'closed') %}
            {{ "\uF11C" | e }}
            {%-elif is_state('cover.velux_downstairs_bathroom', 'open') %}
            {{ "\uF11E" | e }}
            {% endif %}
        event:
          "down":
            - service: cover.stop_cover
              target:
                entity_id: "cover.velux_downstairs_bathroom"
      - obj: "p1b8"
        properties:
          "text_color": "{{ '#FFFF00' if is_state('cover.velux_downstairs_bathroom', 'closing') else '#FFFFFF' }}"
          "text_opa": "{{ '80' if is_state_attr('cover.velux_downstairs_bathroom','current_position', 0) else '255' }}"
        event:
          "down":
            - service: cover.close_cover
              target:
                entity_id: "cover.velux_downstairs_bathroom"


# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"

# End of Alarm Panel




# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.downbath
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}
  downhall:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.downhall','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.downhall','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.downhall','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.hallway_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"

      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.hallway_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"
          
# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.downhall_light_12", "on") else 0 }}'
          "text": '{{ "\uE6E8 Hot Tub" if is_state("light.downhall_light_12", "on") else "\uE335 Hot Tub" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.downhall_light_12"
      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.downhall_light_14", "on") else 0 }}'
          "text": '{{ "\uE6E8 Hallway" if is_state("light.downhall_light_14", "on") else "\uE335 Hallway" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.downhall_light_14"

      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.garden_lights", "on") else 0 }}'
          "text": '{{ "\uE6E8 Garden" if is_state("switch.garden_lights", "on") else "\uE335 Garden" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.garden_lights"

# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"

# End of Alarm Panel




# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.downhall
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}
  ensuite:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.ensuite','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.ensuite','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.ensuite','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.hallway_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"

      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.mbr_ensuite_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"

# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.ensuite_light_12", "on") else 0 }}'
          "text": '{{ "\uE6E8 En Suite" if is_state("light.ensuite_light_12", "on") else "\uE335 En Suite" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.ensuite_light_12"
      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.ensuite_light_14", "on") else 0 }}'
          "text": '{{ "\uE210 Extractor" if is_state("light.ensuite_light_14", "on") else "\uE210 Extractor" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.ensuite_light_14"
      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.mbr_spots", "on") else 0 }}'
          "text": '{{ "\uE6E8 Spots" if is_state("light.mbr_spots", "on") else "\uE6E8 Spots" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.mbr_spots"

      - obj: "p1b4" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("switch.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.unused"
      - obj: "p1b5" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("light.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.unused"
      - obj: "p1b6" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.ensuite_light_27", "on") else 0 }}'
          "text": '{{ "\uE425 Mirror\nSwitch" if is_state("light.ensuite_light_27", "on") else "\uE425 Mirror\nSwitch" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.ensuite_light_27"

      - obj: "p1b7" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.master_bedroom_tv", "on") else 0 }}'
          "text": '{{ "\uE502 TV" if is_state("switch.master_bedroom_tv", "on") else "\uE502 TV" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.master_bedroom_tv"

      - obj: "p1b9" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.mbr_lamps", "on") else 0 }}'
          "text": '{{ "\uE6B5 Lamps" if is_state("light.mbr_lamps", "on") else "\uE6B5 Lamps" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.mbr_lamps"


# Page 2 - Hue Scenes Begin
# Buttons 1-3
      - obj: "p2b1" # Concentrate
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_concentrate", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Concntrte" if is_state("scene.master_bedroom_concentrate", "on") else "Concntrte" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_concentrate"
      - obj: "p2b2" # Spring Blossom
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_spring_blossom", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Spring\nBlossom" if is_state("scene.master_bedroom_spring_blossom", "on") else "Spring\nBlossom" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_spring_blossom"
      - obj: "p2b3" # Tropical Twilight
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_tropical_twilight", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Tropical\nTwilight" if is_state("scene.master_bedroom_tropical_twilight", "on") else "Tropical\nTwilight" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_tropical_twilight"

# Buttons 4-6
      - obj: "p2b4" # Arctic Aurora
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_arctic_aurora", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Arctic\nAurora" if is_state("scene.master_bedroom_arctic_aurora", "on") else "Arctic\nAurora" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_arctic_aurora"
      - obj: "p2b5" # Blue Planet
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_blue_planet", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Blue\nPlanet" if is_state("scene.master_bedroom_blue_planet", "on") else "Blue\nPlanet" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_blue_planet"
      - obj: "p2b6" # Crocus
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_crocus", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Crocus" if is_state("scene.master_bedroom_crocus", "on") else "Crocus" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_crocus"
# Buttons 7-9
      - obj: "p2b7" # Nebula
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_nebula", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Nebula" if is_state("scene.master_bedroom_nebula", "on") else "Nebula" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_nebula"
      - obj: "p2b8" # Ocean\nDawn
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_ocean_dawn", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Ocean\nDawn" if is_state("scene.master_bedroom_ocean_dawn", "on") else "Ocean\nDawn" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_ocean_dawn"
      - obj: "p2b9" # Painted Sky
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_painted_sky", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Painted\nSky" if is_state("scene.master_bedroom_painted_sky", "on") else "Painted\nSky" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_painted_sky"

      - obj: "p2b10" # Light brightness
        properties:
          "val": "{{ state_attr('light.master_bedroom_2', 'brightness') if state_attr('light.master_bedroom_2', 'brightness') != None else 0 }}"
        event:
          "changed":
            - service: light.turn_on
              data:
                entity_id: light.master_bedroom_2
                brightness:  "{{ val }}"
          "up":
            - service: light.turn_on
              data:
                entity_id: light.master_bedroom_2
                brightness:  "{{ val }}"
                
# End of Hue Scenes

# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"

# End of Alarm Panel




# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.livingroom
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}

  garage:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.garage','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.garage','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.garage','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.hallway_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"

      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.hallway_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"

# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.garage_light_12", "on") else 0 }}'
          "text": '{{ "Garage\nSpots" if is_state("light.garage_light_12", "on") else "Garage\nSpots" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.garage_light_12"

      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.downhall_light_14", "on") else 0 }}'
          "text": '{{ "Hallway" if is_state("light.downhall_light_14", "on") else "Hallway" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.downhall_light_14"

      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.shelly_garage_open", "on") else 0 }}'
          "text": '{{ "\uF2D4 Open" if is_state("switch.shelly_garage_open", "on") else "\uF2D4 Open" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.shelly_garage_open"     


      - obj: "p1b4" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("switch.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.unused"

      - obj: "p1b5" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("switch.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.unused"

      - obj: "p1b6" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("switch.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.unused"

      - obj: "p1b7" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.garage_light_14", "on") else 0 }}'
          "text": '{{ "Garage\nLEDs" if is_state("light.garage_light_14", "on") else "Garage\nLEDs" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.garage_light_14"

      - obj: "p1b8" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.garden_lights", "on") else 0 }}'
          "text": '{{ "Garden" if is_state("switch.garden_lights", "on") else "Garden" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.garden_lights"
         
      - obj: "p1b9" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.shelly_garage_close", "on") else 0 }}'
          "text": '{{ "\uF2D3 Close" if is_state("switch.shelly_garage_close", "on") else "\uF2D3 Close" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.shelly_garage_close"

# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"

# End of Alarm Panel




# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.garage
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}
  kitchen:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.kitchen','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.kitchen','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.kitchen','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.hallway_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"

      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.hallway_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"
          
# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.kitchen_light_12", "on") else 0 }}'
          "text": '{{ "Kitchen Spots" if is_state("light.kitchen_light_12", "on") else "Kitchen Spots" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.kitchen_light_12"
      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.kitchen_light_14", "on") else 0 }}'
          "text": '{{ "Cabinet LEDs" if is_state("light.kitchen_light_14", "on") else "Cabinet LEDs" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.kitchen_light_14"

      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.floater", "on") else 0 }}'
          "text": '{{ "Floater" if is_state("switch.floater", "on") else "Floater" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.floater"

      - obj: "p1b4" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("light.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.unused"

      - obj: "p1b5" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("light.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.unused"
              
      - obj: "p1b6" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("light.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.unused"

# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"

# End of Alarm Panel




# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.kitchen
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}
  livingroom:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.livingroom','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.livingroom','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.livingroom','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.hallway_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"

      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.hallway_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"
          
# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.livingroom_light_12", "on") else 0 }}'
          "text": '{{ "\uE210 Fan" if is_state("light.livingroom_light_12", "on") else "\uE210 Fan" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.livingroom_light_12"
      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.living_room_2", "on") else 0 }}'
          "text": '{{ "\uE769 Fan Bulbs" if is_state("light.living_room_2", "on") else "\uE769 Fan Bulbs" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.living_room_2"
      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.livingroom_light_27", "on") else 0 }}'
          "text": '{{ "\uE6E8 Spots" if is_state("light.livingroom_light_27", "on") else "\uE335 Spots" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.livingroom_light_27"


      - obj: "p1b4" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.paulas_lamp", "on") else 0 }}'
          "text": '{{ "\uE6B5 Paulas\nLamp" if is_state("switch.paulas_lamp", "on") else "\uE6B5 Paulas\nLamp" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.paulas_lamp"
      - obj: "p1b5" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.living_room_tv", "on") else 0 }}'
          "text": '{{ "\uE502 TV" if is_state("switch.living_room_tv", "on") else "\uE502 TV" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.living_room_tv"
      - obj: "p1b6" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.livingroom_light_14", "on") else 0 }}'
          "text": '{{ "\uE769 Fan\nSwitch" if is_state("light.livingroom_light_14", "on") else "\uE769 Fan\nSwitch" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.livingroom_light_14"


# Page 2 - Hue Scenes Begin
# Buttons 1-3
      - obj: "p2b1" # Concentrate
        properties:
          "val": '{{ 1 if is_state("scene.living_room_concentrate", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Concntrte" if is_state("scene.living_room_concentrate", "on") else "Concntrte" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.living_room_concentrate"
      - obj: "p2b2" # Spring Blossom
        properties:
          "val": '{{ 1 if is_state("scene.living_room_spring_blossom_2", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Spring\nBlossom" if is_state("scene.living_room_spring_blossom_2", "on") else "Spring\nBlossom" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.living_room_spring_blossom_2"
      - obj: "p2b3" # Tropical Twilight
        properties:
          "val": '{{ 1 if is_state("scene.living_room_tropical_twilight", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Tropical\nTwilight" if is_state("scene.living_room_tropical_twilight", "on") else "Tropical\nTwilight" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.living_room_tropical_twilight"

# Buttons 4-6
      - obj: "p2b4" # Arctic Aurora
        properties:
          "val": '{{ 1 if is_state("scene.living_room_arctic_aurora", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Arctic\nAurora" if is_state("scene.living_room_arctic_aurora", "on") else "Arctic\nAurora" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.living_room_arctic_aurora"
      - obj: "p2b5" # Blue Planet
        properties:
          "val": '{{ 1 if is_state("scene.living_room_blue_planet", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Blue\nPlanet" if is_state("scene.living_room_blue_planet", "on") else "Blue\nPlanet" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.living_room_blue_planet"
      - obj: "p2b6" # Crocus
        properties:
          "val": '{{ 1 if is_state("scene.living_room_crocus", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Crocus" if is_state("scene.living_room_crocus", "on") else "Crocus" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.living_room_crocus"
# Buttons 7-9
      - obj: "p2b7" # Nebula
        properties:
          "val": '{{ 1 if is_state("scene.living_room_nebula", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Nebula" if is_state("scene.living_room_nebula", "on") else "Nebula" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.living_room_nebula"
      - obj: "p2b8" # Ocean\nDawn
        properties:
          "val": '{{ 1 if is_state("scene.living_room_ocean_dawn", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Ocean\nDawn" if is_state("scene.living_room_ocean_dawn", "on") else "Ocean\nDawn" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.living_room_ocean_dawn"
      - obj: "p2b9" # Painted Sky
        properties:
          "val": '{{ 1 if is_state("scene.living_room_painted_sky", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Painted\nSky" if is_state("scene.living_room_painted_sky", "on") else "Painted\nSky" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.living_room_painted_sky"

      - obj: "p2b10" # Light brightness
        properties:
          "val": "{{ state_attr('light.living_room_2', 'brightness') if state_attr('light.living_room_2', 'brightness') != None else 0 }}"
        event:
          "changed":
            - service: light.turn_on
              data:
                entity_id: light.living_room_2
                brightness:  "{{ val }}"
          "up":
            - service: light.turn_on
              data:
                entity_id: light.living_room_2
                brightness:  "{{ val }}"

# End of Hue Scenes

# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"

# End of Alarm Panel



# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.livingroom
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}
  mainhall:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.mainhall','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.mainhall','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.mainhall','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.hallway_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"

      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.hallway_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"
          
# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.mainhall_light_12", "on") else 0 }}'
          "text": '{{ "Hallway" if is_state("light.mainhall_light_12", "on") else "Hallway" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.mainhall_light_12"
      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.office_spots", "on") else 0 }}'
          "text": '{{ "Office\nSpots" if is_state("light.office_spots", "on") else "Office\nSpots" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.office_spots"
      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.landing_fan_lights", "on") else 0 }}'
          "text": '{{ "Landing\nBulbs" if is_state("light.landing_fan_lights", "on") else "Landing\nBulbs" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.landing_fan_lights"


      - obj: "p1b4" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.office_non_ups_devices", "on") else 0 }}'
          "text": '{{ "Non-UPS\nDevices" if is_state("switch.office_non_ups_devices", "on") else "Non-UPS\nDevices" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.office_non_ups_devices"
      - obj: "p1b5" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.shelly_office_fireplace", "on") else 0 }}'
          "text": '{{ "Fireplace" if is_state("switch.shelly_office_fireplace", "on") else "Fireplace" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.shelly_office_fireplace"
      - obj: "p1b6" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.mainhall_light_14", "on") else 0 }}'
          "text": '{{ "\uE335 Landing\nSwitch" if is_state("light.mainhall_light_14", "on") else "\uE335 Landing\nSwitch" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.mainhall_light_14"


      - obj: "p1b7" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.office_lamps", "on") else 0 }}'
          "text": '{{ "Office\nLamp" if is_state("light.office_lamps", "on") else "Office\nLamp" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.office_lamps"
      - obj: "p1b8" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.shelly_office_fan", "on") else 0 }}'
          "text": '{{ "Office\nFan" if is_state("switch.shelly_office_fan", "on") else "Office\nFan" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.shelly_office_fan"
      - obj: "p1b9" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.shelly_landing_fan", "on") else 0 }}'
          "text": '{{ "Landing\nFan" if is_state("switch.shelly_landing_fan", "on") else "Landing\nFan" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.shelly_landing_fan"

# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"

# End of Alarm Panel




# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.mainhall
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}
  mbr:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.mbr','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.mbr','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.mbr','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.velux_mbr_sensor_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"

      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.velux_mbr_sensor_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"

# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.mbr_light_12", "on") else 0 }}'
          "text": '{{ "\uE210 Fan" if is_state("light.mbr_light_12", "on") else "\uE210 Fan" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.mbr_light_12"
      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.mbr_light_14", "on") else 0 }}'
          "text": '{{ "\uE769 Fan Lights" if is_state("light.mbr_light_14", "on") else "\uE769 Fan Lights" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.mbr_light_14"
      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.mbr_spots", "on") else 0 }}'
          "text": '{{ "\uE6E8 Spots" if is_state("light.mbr_spots", "on") else "\uE6E8 Spots" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.mbr_spots"
          

      - obj: "p1b4" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.master_bedroom_tv", "on") else 0 }}'
          "text": '{{ "\uE502 TV" if is_state("switch.master_bedroom_tv", "on") else "\uE502 TV" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.master_bedroom_tv"

      - obj: "p1b5" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.unused", "on") else 0 }}'
          "text": '{{ "Unused" if is_state("light.unused", "on") else "Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.unused"
      - obj: "p1b6" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.mbr_light_27", "on") else 0 }}'
          "text": '{{ "\uE335 Spots\nSwitch" if is_state("light.mbr_light_27", "on") else "\uE335 Spots\nSwitch" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.mbr_light_27"



      - obj: "p1b9" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.mbr_lamps", "on") else 0 }}'
          "text": '{{ "\uE6B5 Lamps" if is_state("light.mbr_lamps", "on") else "\uE6B5 Lamps" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.mbr_lamps"
              
# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"

# End of Alarm Panel




# Page 2 - Hue Scenes Begin
# Buttons 1-3
      - obj: "p2b1" # Concentrate
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_concentrate", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Concntrte" if is_state("scene.master_bedroom_concentrate", "on") else "Concntrte" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_concentrate"
      - obj: "p2b2" # Spring Blossom
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_spring_blossom", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Spring\nBlossom" if is_state("scene.master_bedroom_spring_blossom", "on") else "Spring\nBlossom" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_spring_blossom"
      - obj: "p2b3" # Tropical Twilight
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_tropical_twilight", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Tropical\nTwilight" if is_state("scene.master_bedroom_tropical_twilight", "on") else "Tropical\nTwilight" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_tropical_twilight"

# Buttons 4-6
      - obj: "p2b4" # Arctic Aurora
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_arctic_aurora", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Arctic\nAurora" if is_state("scene.master_bedroom_arctic_aurora", "on") else "Arctic\nAurora" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_arctic_aurora"
      - obj: "p2b5" # Blue Planet
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_blue_planet", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Blue\nPlanet" if is_state("scene.master_bedroom_blue_planet", "on") else "Blue\nPlanet" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_blue_planet"
      - obj: "p2b6" # Crocus
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_crocus", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Crocus" if is_state("scene.master_bedroom_crocus", "on") else "Crocus" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_crocus"
# Buttons 7-9
      - obj: "p2b7" # Nebula
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_nebula", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Nebula" if is_state("scene.master_bedroom_nebula", "on") else "Nebula" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_nebula"
      - obj: "p2b8" # Ocean\nDawn
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_ocean_dawn", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Ocean\nDawn" if is_state("scene.master_bedroom_ocean_dawn", "on") else "Ocean\nDawn" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_ocean_dawn"
      - obj: "p2b9" # Painted Sky
        properties:
          "val": '{{ 1 if is_state("scene.master_bedroom_painted_sky", "on") else 0 }}'
          "text_font": '1'
          "text": '{{ "Painted\nSky" if is_state("scene.master_bedroom_painted_sky", "on") else "Painted\nSky" | e }}'
        event:
          "down":
            - service: scene.turn_on
              entity_id: "scene.master_bedroom_painted_sky"

      - obj: "p2b10" # Light brightness
        properties:
          "val": "{{ state_attr('light.master_bedroom_2', 'brightness') if state_attr('light.master_bedroom_2', 'brightness') != None else 0 }}"
        event:
          "changed":
            - service: light.turn_on
              data:
                entity_id: light.master_bedroom_2
                brightness:  "{{ val }}"
          "up":
            - service: light.turn_on
              data:
                entity_id: light.master_bedroom_2
                brightness:  "{{ val }}"

# End of Hue Scenes

      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 12 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"
      - obj: "p12b1"          # Alarm Arm Away
        event:
          "up":
            - service: >
                {% if val == 13 %}
                alarm_control_panel.alarm_arm_away
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"
                
      - obj: "p12b1"          # Alarm Disarm
        event:
          "up":
            - service: >
                {% if val == 14 %}
                alarm_control_panel.alarm_disarm
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"



# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.livingroom
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}
  porch:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.porch','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.porch','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.porch','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.hallway_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"
      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.hallway_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"

# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.porch_light_12", "on") else 0 }}'
          "text": '{{ "\uE6E8 Front Lights" if is_state("light.porch_light_12", "on") else "\uE335 Front Lights" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.porch_light_12"
      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.porch_light_14", "on") else 0 }}'
          "text": '{{ "\uE6E8 Porch" if is_state("light.porch_light_14", "on") else "\uE335 Porch" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.porch_light_14"
      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.garden_lights", "on") else 0 }}'
          "text": '{{ "\uE6E8 Garden" if is_state("switch.garden_lights", "on") else "\uE335 Garden" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.garden_lights"

      - obj: "p1b4" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.flood_light", "on") else 0 }}'
          "text": '{{ "\uE5A8 Flood" if is_state("switch.flood_light", "on") else "\uE5A8 Flood" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.flood_light"

# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"

# End of Alarm Panel




# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.porch
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}
  upbath:
    objects:

# Begin Header

      - obj: "p0b1"
        properties:
          "text_color": "{% if -50 <= state_attr('openhasp.upbath','rssi') |int %}#00ff00{% elif -51 > state_attr('openhasp.upbath','rssi') |int >= -70 %}#ffff00{% elif -71 > state_attr('openhasp.upbath','rssi') |int >= -80 %}#ff0000{% else %}black{% endif %}"
      - obj: "p0b2"
        properties:
          "text": "{{ states('sensor.monthly_energy_cost') }}"
      - obj: "p0b4"
        properties:
          "text": "{{ states('sensor.octopus_energy_previous_accumulative_cost') }}"
      - obj: "p0b7"
        properties:
          "text": "{{ states('sensor.myenergi_harvi_13532093_power_ct_grid') }}"
      - obj: "p0b8"
        properties:
          "text": "{% if 300 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE32A{% elif 3500 <= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}\uE5F1{% else %}\uF40B{% endif %}"
          "text_color": "{% if 500 >= states('sensor.myenergi_harvi_13532093_power_ct_grid') |int %}#00ff00{% elif 500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 1000 %}#ffff00{% elif 1000 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 3500 %}#ff0000{% elif 3500 < states('sensor.myenergi_harvi_13532093_power_ct_grid') |int <= 20000 %}#00ff00{% else %}black{% endif %}"
      - obj: "p0b5"
        properties:
          "text": "{{ states('sensor.hallway_temperature') }}"
      - obj: "p0b14"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'temperature') }}"

      # - obj: "p0b21"
      #   properties:
      #     "text": "{{ states('sensor.velux_mbr_sensor_co2') }}"
      - obj: "p0b30"
        properties: 
          "text": "{{ states('sensor.hallway_humidity') }}"
      - obj: "p0b31"
        properties:
          "text": "{{ state_attr('weather.beech_house', 'humidity') }}"
          
# End Header

      - obj: "p1b1" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.upbath_light_12", "on") else 0 }}'
          "text": '{{ "\uE6E8 Bathroom" if is_state("light.upbath_light_12", "on") else "\uE335 Bathroom" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.upbath_light_12"

      - obj: "p1b2" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.upbath_light_14", "on") else 0 }}'
          "text": '{{ "\uE210 Extractor" if is_state("light.upbath_light_14", "on") else "\uE210 Extractor" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.upbath_light_14"
      - obj: "p1b3" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.upbath_light_27", "on") else 0 }}'
          "text": '{{ "\uE6E8 Unused" if is_state("light.upbath_light_27", "on") else "\uE335 Unused" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.upbath_light_27"


      - obj: "p1b4" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.alastairs_bedroom_leds", "on") else 0 }}'
          "text": '{{ "\uF2BA Ally\nLEDs" if is_state("switch.alastairs_bedroom_leds", "on") else "\uF2BA Ally\nLEDs" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.alastairs_bedroom_leds"
      - obj: "p1b5" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("light.the_best_light", "on") else 0 }}'
          "text": '{{ "\uE769 Ally\nBedroom" if is_state("light.the_best_light", "on") else "\uE769 Ally\nBedroom" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "light.the_best_light"
      - obj: "p1b6" # switch, checkbox or btn with toggle true
        properties:
          "val": '{{ 1 if is_state("switch.alastairs_office", "on") else 0 }}'
          "text": '{{ "\uE95F Ally\nOffice" if is_state("switch.alastairs_office", "on") else "\uE95F Ally\nOffice" | e }}'
        event:
          "down":
            - service: homeassistant.toggle
              entity_id: "switch.alastairs_office"

# Beginning of Alarm Panel
      - obj: "p12b1"          # Alarm Arm Home
        event:
          "up":
            - service: >
                {% if val == 9 %}
                alarm_control_panel.alarm_arm_home
                {% endif %}
              target:
                entity_id: "alarm_control_panel.alarm"
              data:
                code: "1776"
# End of Alarm Panel





# Next Theremostat Control

      - obj: "p11b20"  # arc slider
        properties:
          "val": "{{ state_attr('climate.hallway','temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "line_color1": >
            {% if is_state('climate.hallway', 'cool') %}
            {{ "#346beb" }}
            {%-elif is_state('climate.hallway', 'heat_cool') %}
            {{ "#34bdeb" }}
            {%-elif is_state('climate.hallway', 'heat') %}
            {{ "#eb3434" }}
            {%-elif is_state('climate.hallway', 'dry') %}
            {{ "#ebeb34" }}
            {%-elif is_state('climate.hallway', 'fan_only') %}
            {{ "#34eb77" }}
            {%-else %}
            {{ "#9f96b0" }}
            {% endif %}
        event:
          "changed":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ val | int / 10 }}"

      - obj: "p11b21"  # gauge current temp
        properties:
          "val": "{{ state_attr('climate.hallway','current_temperature') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "min": "{{ state_attr('climate.hallway','min_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "max": "{{ state_attr('climate.hallway','max_temp') * 10 | int if not (is_state('climate.hallway','unavailable')) }}"
          "critical_value": "{{ (state_attr('climate.hallway','max_temp') * 10 | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "label_count": "{{ (state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int + 1) if not (is_state('climate.hallway','unavailable')) }}"
          "line_count": "{{ ((state_attr('climate.hallway','max_temp') | int - state_attr('climate.hallway','min_temp') | int) * 2 + 1) if not (is_state('climate.hallway','unavailable')) }}"

      - obj: "p11b23"  # label current temp (and +/- with short/long touch)
        properties:
          "text": "{{ state_attr('climate.hallway','current_temperature') if not (is_state('climate.hallway','unavailable')) }}"
        event:
          "up":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') + state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 
          "long":
            - service: climate.set_temperature
              target:
                entity_id: climate.hallway
              data:
                temperature: "{{ state_attr('climate.hallway','temperature') - state_attr('climate.hallway','target_temp_step') | float(default=0)}}" 


      - obj: "p11b25"  # label target temp
        properties:
          "text": "{{ state_attr('climate.hallway','temperature') if not (is_state('climate.hallway','unavailable')) }}"


      - obj: "p11b41"  # on/off switch
        properties:
          "val": "{{ 0 if (is_state('climate.hallway', 'off') or is_state('climate.hallway', 'unavailable')) else 1 }}"
        event:
          "down":
            - service_template: >
                {% if val == 0 -%}
                climate.turn_on
                {% else -%}
                climate.turn_off
                {% endif -%}
              entity_id: "climate.hallway"

      - obj: "p11b30"  # tab dots
        event:
          "changed":
            - service: openhasp.command
              target:
                entity_id: openhasp.upbath
              data:
                keyword: p11b26.text
                parameters: >
                  {% if val == 0 %}
                  {{ "#000000 \u2022# #909090 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 1 %}
                  {{ "#909090 \u2022# #000000 \u2022# #909090 \u2022#" | e }}
                  {%-elif val == 2 %}
                  {{ "#909090 \u2022# #909090 \u2022# #000000 \u2022#" | e }}
                  {% endif %}

      - obj: "p11b42"  # dropdown with fan_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {%- if mode == 'auto' -%}
            Automatic{{"\n"|e}}
            {%- elif mode == 'low' -%}
            Low{{"\n"|e}}
            {%- elif mode == 'medium' -%}
            Medium{{"\n"|e}}
            {%- elif mode == 'high' -%}
            High{{"\n"|e}}
            {%- elif mode == 'turbo' -%}
            Turbo{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','fan_modes')%}
            {{loop.index -1 if mode == state_attr('climate.hallway','fan_mode') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_fan_mode
              target:
                entity_id: climate.hallway
              data:
                fan_mode: >
                  {% if text == "Automatic" -%}
                  auto
                  {% elif text == 'Low' -%}
                  low
                  {% elif text == 'Medium' -%}
                  medium
                  {% elif text == 'High' -%}
                  high
                  {% elif text == 'Turbo' -%}
                  turbo
                  {% endif -%}

      - obj: "p11b43"  # dropdown with hvac_modes
        properties:
          "options": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {%- if mode == 'off' -%}
            Off{{"\n"|e}}
            {%- elif mode == 'heat' -%}
            Heating{{"\n"|e}}
            {%- elif mode == 'cool' -%}
            Cooling{{"\n"|e}}
            {%- elif mode == 'heat_cool' -%}
            Heat/Cool{{"\n"|e}}
            {%- elif mode == 'dry' -%}
            Drying{{"\n"|e}}
            {%- elif mode == 'fan_only' -%}
            Fan only{{"\n"|e}}
            {%- else -%}
            On{{"\n"|e}}
            {%- endif -%}
            {%-if not loop.last%}{%-endif%}{%-endfor%}{% endif %}
          "val": >
            {% if not (is_state('climate.hallway','unavailable')) %}{%for mode in state_attr('climate.hallway','hvac_modes')%}
            {{loop.index -1 if mode == states('climate.hallway') }}
            {%-endfor%}{% endif %}
        event:
          "changed":
            - service: climate.set_hvac_mode
              target:
                entity_id: climate.hallway
              data:
                hvac_mode: >
                  {% if text == "Off" -%}
                  off
                  {% elif text == 'Heating' -%}
                  heat
                  {% elif text == 'Cooling' -%}
                  cool
                  {% elif text == 'Heat/Cool' -%}
                  heat_cool
                  {% elif text == 'Drying' -%}
                  dry
                  {% elif text == 'Fan only' -%}
                  fan_only
                  {% endif -%}
